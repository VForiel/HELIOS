# Agent Modification Log: 2025.11.25-07_architecture-diagram

## Date
2025-11-25

## Summary
Ajout d'un diagramme UML architectural en Mermaid dans la page principale de la documentation pour illustrer l'architecture en couches (layers) de HELIOS et les flux de donn√©es entre composants.

## Files Modified

### Documentation
- `docs/index.md`
  - Ajout d'une section "Architecture Overview" avec diagramme Mermaid
  - Diagramme flowchart montrant tous les types de layers et leurs interactions
  - L√©gende explicative des concepts cl√©s (sequential processing, parallel processing, orchestration)

### Configuration
- `docs/conf.py`
  - Ajout de l'extension `sphinxcontrib.mermaid` dans la liste des extensions Sphinx
  - Permet le rendu des diagrammes Mermaid dans la documentation HTML

### Dependencies
- Installation de `sphinxcontrib-mermaid==1.2.2` dans l'environnement virtuel

## Diagramme Cr√©√©

### Structure du Diagramme
Le diagramme UML flowchart repr√©sente 5 cat√©gories de composants:

1. **Context (Orchestrator)** - Rose
   - `observe()` : m√©thode principale d'orchestration

2. **Scene Layer** - Beige/Orange
   - ‚≠ê Star (√©toiles)
   - ü™ê Planet (plan√®tes)
   - Zodiacal (lumi√®re zodiacale)
   - ExoZodiacal (poussi√®re exozodiacale)

3. **Optical Layers** - Bleu clair
   - üî≠ Collectors (ouvertures de t√©lescope)
   - ‚óØ Pupil (g√©om√©trie d'ouverture)
   - üå´Ô∏è Atmosphere (turbulence atmosph√©rique)
   - ‚ú± Coronagraph (suppression de lumi√®re stellaire)
   - üîÑ AdaptiveOptics (correction de front d'onde)
   - ‚ö° BeamSplitter (s√©paration de faisceaux)

4. **Photonic Layers** - Violet
   - üíé PhotonicChip (circuits photoniques int√©gr√©s)
   - TOPS (three-output pupil slicer)
   - MMI (multi-mode interferometer)

5. **Detector Layers** - Vert
   - üì∑ Camera (couche terminale produisant ndarray)

### Types de Connexions
- **Fl√®ches solides** (`-->`) : Propagation s√©quentielle du wavefront
  - Exemple: `Scene --> Collectors --> Atmosphere --> Pupil --> Coronagraph`
  
- **Fl√®ches pointill√©es** (`-.->`) : Orchestration par le Context
  - Le Context g√®re toutes les couches mais ne transforme pas le signal
  
- **Branches parall√®les** : Apr√®s BeamSplitter
  - Un chemin vers Photonics
  - Un chemin direct vers Camera

### √âl√©ments Visuels
- **Emojis** : Identification visuelle rapide des composants (üî≠, üå´Ô∏è, üì∑, etc.)
- **Couleurs de fond** : Cat√©gorisation par type de layer
- **Labels descriptifs** : R√¥le de chaque composant entre parenth√®ses
- **R√©sultat final** : Box jaune montrant le ndarray de sortie

## Concepts Document√©s

### Key Concepts (L√©gende)
1. **Sequential Processing** : Fl√®ches solides montrant le chemin de propagation
2. **Parallel Processing** : Branches multiples apr√®s BeamSplitter
3. **Context Orchestration** : Lignes pointill√©es montrant la gestion globale
4. **Terminal Layer** : Camera produit la sortie finale (numpy array)

### Flux de Donn√©es Typique
```
Scene (objets c√©lestes)
  ‚Üì Wavefront
Collectors (collecte de lumi√®re)
  ‚Üì Wavefront
Atmosphere (turbulence)
  ‚Üì Wavefront
Pupil (masque d'ouverture)
  ‚Üì Wavefront
Coronagraph (suppression stellaire)
  ‚Üì Wavefront
AdaptiveOptics (correction)
  ‚Üì Wavefront
BeamSplitter (division)
  ‚Üì‚Üì Split Beams
  ‚îú‚Üí Photonics ‚Üí Camera
  ‚îî‚Üí Camera (direct)
    ‚Üì ndarray
  Final Image
```

## Technical Implementation

### Mermaid Syntax Used
```mermaid
flowchart TB
    subgraph Category["Category Name"]
        direction TB/LR
        Component["Label"]
    end
    
    Component1 --> |Label| Component2
    Component3 -.-> |Label| Component4
```

### Rendering
- Mermaid diagrammes sont rendus c√¥t√© client via JavaScript
- Sphinx g√©n√®re le code Mermaid dans le HTML
- Le navigateur ex√©cute mermaid.js pour cr√©er le SVG

### Customization
- `style Category fill:#color` : Couleurs de fond personnalis√©es
- Direction: `TB` (top-to-bottom), `LR` (left-to-right)
- Emojis Unicode int√©gr√©s dans les labels

## Build Process

### Commands
```bash
cd d:\HELIOS\docs
.\make.bat html
```

### Output
- Documentation HTML avec diagramme interactif
- 16 warnings (unchanged, formatage de docstrings)
- Diagramme rendu avec succ√®s dans `_build/html/index.html`

## Educational Value

### Avantages P√©dagogiques
1. **Visualisation imm√©diate** : Comprendre l'architecture en un coup d'≈ìil
2. **Identification des composants** : Emojis et couleurs facilitent la m√©morisation
3. **Flux de donn√©es clair** : Fl√®ches montrant comment le signal se propage
4. **Cat√©gorisation** : Regroupement par fonction (sc√®ne, optique, photonique, d√©tecteur)

### Public Cible
- **Nouveaux utilisateurs** : Comprendre rapidement l'organisation du package
- **Scientifiques non-experts** : Vue d'ensemble sans d√©tails techniques
- **D√©veloppeurs** : Architecture pour contribuer de nouveaux layers
- **√âtudiants** : Support visuel pour l'apprentissage

## Alignment with Project Philosophy

### Scientific Rigor ‚úÖ
- Diagramme fid√®le √† l'architecture r√©elle du code
- Terminologie correcte (Wavefront, Context, Layer)
- Flux de donn√©es physiquement coh√©rent

### Educational Clarity ‚úÖ
- Simplification visuelle sans perte d'information
- L√©gende explicative des concepts cl√©s
- Emojis pour identification intuitive

### Documentation Quality ‚úÖ
- Int√©gration native dans Sphinx (pas d'image externe)
- Source versionnable (texte Mermaid, pas binaire)
- Responsive et accessible

## Future Enhancements (Recommendations)
1. **Diagramme interactif** : Liens cliquables vers pages de documentation de chaque composant
2. **Variantes du diagramme** : 
   - Diagramme simplifi√© pour d√©butants
   - Diagramme d√©taill√© avec sous-composants
3. **Animation** : Montrer le flux de donn√©es en mouvement
4. **Exemples de pipelines** : Diagrammes pour cas d'usage sp√©cifiques (coronagraphy, interferometry)
5. **Diagramme de classes UML** : Relations d'h√©ritage entre Layer et sous-classes

## Testing
- ‚úÖ Build Sphinx r√©ussi
- ‚úÖ Diagramme rendu dans HTML
- ‚úÖ Emojis affich√©s correctement
- ‚úÖ Couleurs appliqu√©es aux subgraphs
- ‚úÖ Fl√®ches et labels lisibles
