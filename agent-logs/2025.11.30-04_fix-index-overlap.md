# Fix: UML Diagram Index Overlap with Component Labels

**Date:** 2025-11-30  
**Issue:** Layer indices `[layer,sublayer]` were overlapping with the two-line component labels (name + type)

## Problem Description

After implementing two-line labels for components (name on first line, type in parentheses on second line), the layer indices were positioned too close to the labels:

- **Name label**: positioned at `y - 0.12`
- **Type label**: positioned at `y - 0.30`
- **Index label**: positioned at `y - 0.55` ❌ **TOO CLOSE!**

This caused visual overlap between the type label and the index.

## Solution

Increased the vertical spacing for index positioning from `y - 0.55` to `y - 0.75`:

```python
# Before
y_label = y_pos - 0.55

# After
y_label = y_pos - 0.75  # More spacing to avoid overlap with two-line labels
```

### Spacing Breakdown

Now the vertical positions are:
- **Component box**: centered at `y`
- **Name label**: `y - 0.12` (first line, bold)
- **Type label**: `y - 0.30` (second line, gray)
- **Index label**: `y - 0.75` (sufficient clearance)

Total clearance: `0.75 - 0.30 = 0.45` units between type label and index.

## Files Modified

- `src/helios/core/context.py`:
  - `_add_layer_numbering()`: Changed `y_label = y_pos - 0.55` → `y_label = y_pos - 0.75`
  - Added explanatory comment about two-line label positions

## Validation

- ✅ `test_sublayer_numbering.py` passes
- ✅ No overlap between indices and labels
- ✅ Visual spacing is clear and readable
- ✅ Indices remain centered below each component

## Visual Result

```
┌─────────────┐
│   [icon]    │  ← Component box
└─────────────┘
   Component      ← Name (y - 0.12)
   (Type)         ← Type (y - 0.30)
                  ← Clear space
     [4,2]        ← Index (y - 0.75)
```

## Backward Compatibility

✅ No breaking changes - all existing diagrams will now have better spacing.
